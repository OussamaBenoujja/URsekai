                             'Authorization': `Bearer ${token}`,
                             'Content-Type': 'application/json'
                         },
                         body: JSON.stringify({ password })
                     });
                     const data = await resp.json();
                     if (resp.ok) {
                         showStatus('2FA disabled successfully!');
                         userTwofaEnabled = false;
                         update2faUI();
                         updatePasswordOtpField();
                     } else {
                         showStatus(data.message || 'Failed to disable 2FA', true);
                     }
                 });
                 const passwordOtpGroup = document.getElementById('2fa-password-otp-group');
                 function updatePasswordOtpField() {
                     if (userTwofaEnabled) {
                         passwordOtpGroup.style.display = '';
                     } else {
                         passwordOtpGroup.style.display = 'none';
                     }
                 }
                 const passwordForm = document.getElementById('passwordForm');
                 passwordForm.addEventListener('submit', function(e) {
                     e.preventDefault();
                     const currentPassword = document.getElementById('current_password').value;
                     const newPassword = document.getElementById('password').value;
                     const confirmPassword = document.getElementById('password_confirmation').value;
                     const otp = document.getElementById('password_otp').value;
                     if (newPassword !== confirmPassword) {
                         showStatus('New passwords do not match.', true);
                         return;
                     }
                     if (newPassword.length < 8) {
                         showStatus('New password must be at least 8 characters long.', true);
                         return;
                     }
                     const payload = {
                         current_password: currentPassword,
                         password: newPassword,
                         password_confirmation: confirmPassword
                     };
                     if (userTwofaEnabled) {
                         payload.otp = otp;
                     }
                     updatePassword(payload);
                 });
                 fetch2faStatus();
             });
